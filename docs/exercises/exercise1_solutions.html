<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exercise 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="exercise1_files/libs/clipboard/clipboard.min.js"></script>
<script src="exercise1_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="exercise1_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="exercise1_files/libs/quarto-html/popper.min.js"></script>
<script src="exercise1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="exercise1_files/libs/quarto-html/anchor.min.js"></script>
<link href="exercise1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="exercise1_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="exercise1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="exercise1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="exercise1_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exercise 1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this exercise you will get acquainted with R and RStudio. RStudio adds many convenience features to the base R that you obtained from <a href="http://r-project.org">http://r-project.org</a>. Most of these features go beyond the scope of this course, but some of them will flatten the learning curve of R programming.</p>
<p>If you have any questions, feel free to ask me or the workgroup instructor.</p>
<p>OK. Let’s begin!</p>
<hr>
<section id="working-with-r-and-rstudio" class="level1">
<h1>Working with R and RStudio</h1>
<hr>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<p><strong>Open RStudio</strong></p>
<p>The following window will appear. <img src="figures/rstudio1.png" class="img-fluid" alt="alt text"></p>
<p>RStudio is divided into 3 panes: the console, the environment/history pane, and a pane wherein you can access your files, plots, help files, etc. You can rearrange the panes through RStudio’s preferences.</p>
<p>When we open an R script (i.e.&nbsp;a file that contains R code), a fourth pane will open to show the script.</p>
<hr>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
<p><strong>Open a new R script</strong></p>
<p>In the top left you will find this button: <img src="figures/fig2.png" class="img-fluid" style="width:5.0%" alt="new script">. Click it and select “R Script”.</p>
<p>A new pane will open, and you can start writing code in this new script. Unless you’re just using R as a simple calculator, you should work with R scripts instead of writing your code directly in the console. Doing so has at least the following advantages.</p>
<ol type="a">
<li>You will not lose your work, since all of the commands you execute are written in a script.<br>
</li>
<li>You log your workflow. Code does not disappear over time, so you can always tell what analyses you did for a project.</li>
<li>With access to your R script(s) and data, others can exactly reproduce your work.<br>
</li>
<li>You coding will become more organized as you start trying to write more readable code. In the long run, this increased organization will make you a more efficient programmer. Remember: Efficient code runs faster!</li>
</ol>
<hr>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2"></h2>
<p><strong>Type the following into your new R script</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hey, Buddy! Let's assign the value 100 to the object a.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The comment character, <code>#</code>, tells the R interpreter to ignore everything that follows in that specific line. Since nothing following a <code>#</code> will be interpreted as R code, you can use <code>#</code> to comment your code.</p>
<p>The line <code>a &lt;- 100</code> assigns the value <code>100</code> to the object <code>a</code>. When you run this line, a new object called <code>a</code> will be saved to your environment and given the value <code>100</code>. The value <code>100</code> and the name <code>a</code> are completely arbitrary. You could just as well assign the value<code>"bar"</code> to the object <code>foo</code>, if you like.</p>
<hr>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3"></h2>
<p><strong>Execute the commands in your script</strong></p>
<p>Select both lines of code shown above, and execute them by pressing Ctrl-Enter or Ctrl-R (Windows/Linux) or Cmd-Enter (Mac)</p>
<p>After your code is executed the results appear in the console. If you type <code>a</code> in the console, R will return the assigned value. Try it. <img src="figures/rstudio2.png" class="img-fluid" alt="alt text"></p>
<p>The shortcut Ctrl-Enter or Cmd-Enter is your friend: it runs the current selection, or—if nothing is selected—the current line. If pressing Ctrl-Enter or Cmd-Enter yields no result, you probably have the console pane selected. You can switch to the code pane by using the mouse to click on the desired line in the code pane or by pressing Ctrl-1 (Windows/Linux/Mac). You can select the console by pressing Ctrl-2 (Windows/Linux/Mac).</p>
<hr>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4"></h2>
<p><strong>Save your code file as <em>practical_1.R</em> in a folder named <em>practicals</em></strong></p>
<p>You can use the standard Ctrl-s (Windows/Linux) or Cmd-s (Mac) or click on the <img src="figures/fig4.png" class="img-fluid" style="width:3.0%" alt="save button"> icon in the code pane. Your document is now saved. Saving your script in a separate folder will allow you to create an RStudio project for your practicals.</p>
<hr>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5"></h2>
<p><strong>Close the <em>practical_1.R</em> script in the code pane</strong></p>
<p>Even though you’ve closed the script, your code is still saved as a permanent code file.</p>
</section>
<section id="section-6" class="level2">
<h2 class="anchored" data-anchor-id="section-6"></h2>
<p><strong>Open the <em>practical_1.R</em> script</strong></p>
<ol type="1">
<li>Navigate to the <em>practicals</em> directory using the RStudio files pane.</li>
<li>Click on the <em>practical_1.R</em> file in the files pane to re-open the script.</li>
<li>Run both lines of code again.</li>
<li>Inspect the contents of the global environment by executing the <code>ls()</code> function.</li>
</ol>
<p>You should see something like the following</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a"</code></pre>
</div>
</div>
<p>There is only one object in the environment, and it is called <code>a</code>. If you look at the environment pane, you can quickly see which objects currently exist in the environment (i.e., you don’t need to manually run <code>ls()</code>). You can also see some information about the objects.</p>
<hr>
</section>
</section>
<section id="rstudio-projects" class="level1">
<h1>RStudio Projects</h1>
<hr>
<section id="section-7" class="level2">
<h2 class="anchored" data-anchor-id="section-7"></h2>
<p><strong>Create a new RStudio project</strong></p>
<ol type="1">
<li>Click on the <img src="figures/fig5.png" class="img-fluid" style="width:15.0%" alt="project button"> button in the top-right corner of RStudio.</li>
<li>Select “New Project”</li>
<li>Click on “Existing Directory”</li>
<li>Navigate to the folder where you just saved your code.</li>
<li>Click on “Create Project”.</li>
</ol>
<p>You will notice that the file <em>practicals.Rproj</em> appears in the files pane.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/files_pane.png" class="img-fluid figure-img"></p>
<figcaption>Files Pane</figcaption>
</figure>
</div>
<p>The possibility of categorizing your work into projects is one of the benefits of using RStudio. Within a project, everything is related to the <em>.Rproj</em> file. So, if you share the project with someone else, they only have to open the <em>.Rproj</em> file to access and run any code from the project.</p>
<hr>
</section>
</section>
<section id="rstudio-notebooks" class="level1">
<h1>RStudio Notebooks</h1>
<hr>
<section id="section-8" class="level2">
<h2 class="anchored" data-anchor-id="section-8"></h2>
<p><strong>Open the R script <em>notebook.R</em></strong></p>
<p>You can download a ZIP archive containing <em>notebook.R</em> <a href="notebook.zip">here</a>.</p>
<hr>
</section>
<section id="section-9" class="level2">
<h2 class="anchored" data-anchor-id="section-9"></h2>
<p><strong>Have a look at the code in the script and make sure that you understand what it does.</strong></p>
<hr>
</section>
<section id="section-10" class="level2">
<h2 class="anchored" data-anchor-id="section-10"></h2>
<p><strong>Compile the script as an HTML file</strong></p>
<p>Click on the <img src="figures/fig7.png" class="img-fluid" alt="alt text"> icon and select “HTML” as the output format.</p>
<p>The benefit of using HTML as an output format lies in the dimensional properties of a web-page. Especially when dealing with long code files, large output from analyses, or many figures, exporting your file as HTML is much more convenient than using paginated output formats (e.g., MS Word, PDF). With HTML output, you can simply scroll down or up to any part of the document, instead of flipping through pages back and forth to compare code, graphs, or output.</p>
<hr>
</section>
<section id="section-11" class="level2">
<h2 class="anchored" data-anchor-id="section-11"></h2>
<p><strong>Inspect the HTML file you have created</strong></p>
<p>The notebook feature in RStudio is very convenient; it runs any R code and converts the results into a readable file where code and output are both visible. There is, however, an even better format for integrating R code with text into a single document: <strong>markdown</strong>!</p>
<hr>
</section>
</section>
<section id="markdown" class="level1">
<h1>Markdown</h1>
<hr>
<section id="about-quarto-markdown" class="level2">
<h2 class="anchored" data-anchor-id="about-quarto-markdown">About Quarto markdown</h2>
<p><a href="https://quarto.org/">Quarto</a> is a tool for creating documents that combine code, results, and narrative text in one file. Like Jupyter notebooks, Quarto markdown documents provide a cleaner, more professional, more reproducible way to publish analyses compared to plain code scripts.</p>
<hr>
</section>
<section id="section-12" class="level2">
<h2 class="anchored" data-anchor-id="section-12"></h2>
<p><strong>Open the file <em>markdown.qmd</em></strong></p>
<p>You can download a ZIP archive containing <em>markdown.qmd</em> <a href="markdown.zip">here</a></p>
<p>Have a look at the code in the <em>markdown.qmd</em> file and make sure that you understand what’s going on.</p>
<hr>
</section>
<section id="section-13" class="level2">
<h2 class="anchored" data-anchor-id="section-13"></h2>
<p><strong>Compile the Quarto document into an HTML file</strong></p>
<ol type="1">
<li>Click the <img src="figures/render.png" class="img-fluid" alt="render button"> button to compile the file into an HTML document.
<ul>
<li>If necessary, install the required packages.</li>
</ul></li>
<li>Inspect the HTML file and compare it to the one you created from the <em>notebook.R</em> file.</li>
</ol>
<p>In the rest of this course, you will need to complete and submit exercises and assignments. The notebook functionality is a convenient way to quickly compile code and output into a quick-and-dirty report that you can discuss with others. The rmarkdown functionality in RStudio, on the other hand, is a well-polished production device to mark-up high quality documents where text and code/output are woven together.</p>
<ul>
<li>Please use Quarto markdown to prepare your work for this course, and submit both the <code>qmd</code> and HTML files whenever you need to hand in exercises or assignments.</li>
</ul>
<hr>
<p>End of Exercise 1</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>